# 数据看板需求文档

## 1. 概述
数据看板旨在提供全面的业务数据分析，帮助管理员实时监控和评估各渠道、各账号的业务表现。看板汇集了进线、开口、留资等核心指标，并提供多维度的排行和详细数据报表，支持对客服账号、短视频计划及直播间的转化效果进行深度分析。

## 2. 核心功能模块

### 2.1 全局筛选
*   **功能描述**：页面顶部提供全局时间筛选器，控制看板内所有数据的统计范围。
*   **筛选选项**：
    *   今日
    *   昨日
    *   最近 7 天（默认选中）
    *   最近 30 天
*   **数据逻辑**：切换时间范围时，所有展示数据（包括概览、排行、明细表）应动态更新。当前版本使用模拟数据倍率（Multipliers）来演示不同时间段的数据变化。

### 2.2 核心指标概览 (Overview Cards)
展示四个关键业务指标的统计卡片：
1.  **总接待量 (Incoming)**：选定时间段内的总进线人数。
2.  **开口数 (Opening)**：用户产生实际对话的数量。
3.  **留资数 (Leads)**：成功获取客户联系方式或意向的数量。
4.  **平均转化率 (Conversion Rate)**：整体的留资转化率（留资数 / 开口数）。

### 2.3 数据排行榜 (Rankings)
提供三组 Top 5 排行榜，支持按“最高”或“最低”进行排序切换：
1.  **线索数量排行**：按留资数（Leads）排序。
2.  **转化率排行**：按留资转化率（Rate）排序。
3.  **开口率排行**：按开口率（Opening Rate）排序。
*   **展示细节**：前三名显示金/银/铜色徽章，其余显示普通序号；包含账号名称及核心数值。

## 3. 详细数据报表

### 3.1 客服账号转化详情 (Agent Performance)
*   **维度**：以“客服账号”为核心维度。
*   **列表字段**：
    *   账号名称
    *   进线量 (Incoming)
    *   开口量 (Opening)
    *   开口率 (Opening Rate = Opening / Incoming)
    *   留资量 (Lead)
    *   留资转化率 (Lead Conversion Rate = Lead / Opening)
    *   进线留咨率 (Incoming Lead Rate = Lead / Incoming)
*   **交互功能**：
    *   **展开详情**：点击行可展开查看该账号下的分渠道数据（直播、自然流、短视频）。
    *   **搜索**：支持按账号名称模糊搜索。
    *   **筛选**：支持按账号名称精确筛选。

### 3.2 短视频转化详情 (Short Video Performance)
*   **维度**：以“短视频计划”为核心维度。
*   **列表字段**：
    *   短视频计划名称
    *   所属抖音账号
    *   进线量、开口量、开口率、留资量、留资转化率、进线留咨率。
*   **交互功能**：
    *   **展开详情**：点击行可展开查看该计划下的具体素材（Material）数据，显示短视频ID及对应指标。
    *   **搜索/筛选**：支持按计划名称搜索及按抖音账号筛选。
*   **备注**：文案已从“广告”统一调整为“短视频”。

### 3.3 直播转化详情 (Live Performance)
*   **维度**：以“直播间/直播主题”为核心维度。
*   **列表字段**：
    *   抖音账号（直播间所属账号）
    *   进线量、开口量、开口率、留资量、留资转化率、进线留咨率。
*   **交互功能**：
    *   **搜索/筛选**：支持按直播主题搜索及按抖音账号筛选。

## 4. 数据逻辑与模拟
当前前端使用 Mock 数据配合倍率算法来模拟真实业务场景：
*   **Mock 数据源**：
    *   `AGENT_PERFORMANCE_BASE`: 客服账号基准数据。
    *   `AD_PERFORMANCE_BASE`: 短视频计划基准数据。
    *   `LIVE_PERFORMANCE_BASE`: 直播间基准数据。
*   **倍率算法 (adjustData)**：
    *   今日：x 0.14
    *   昨日：x 0.15
    *   最近 7 天：x 1.0 (基准)
    *   最近 30 天：x 4.2
*   **计算公式**：
    *   所有率值（如开口率、转化率）均在应用倍率后的新数值上重新计算，保留一位小数。

## 5. UI/UX 规范
*   **配色**：使用 Slate 色系作为主文本色，Blue/Indigo/Green/Purple 色系区分不同指标模块。
*   **图标**：统一使用 `lucide-react` 图标库。
*   **响应式**：表格支持横向滚动，卡片在移动端自动堆叠。

## 6. 名词解释

### 6.1 基础指标
*   **进线量 (Incoming)**
    *   **定义**：在选定时间段内，成功接入到客服系统或访问直播间/短视频落地页的访客总人次。
    *   **统计方式**：基于系统接入日志计数，去重逻辑视具体业务场景而定（当前版本为 UV 计数）。
*   **开口量 (Opening)**
    *   **定义**：在进线访客中，产生实际互动行为（如发送第一条消息、点击互动按钮）的用户数量。
    *   **统计方式**：`Count(User)` where `MessageCount > 0`。
*   **留资量 (Lead)**
    *   **定义**：在互动过程中，成功留下有效联系方式（如手机号、微信）或填写表单的用户数量。
    *   **统计方式**：`Count(User)` where `HasContactInfo = true`。

### 6.2 转化率指标
*   **开口率 (Opening Rate)**
    *   **意义**：衡量前端流量承接能力和主动营销效果。
    *   **计算公式**：`开口率 = (开口量 / 进线量) * 100%`
*   **留资转化率 (Lead Conversion Rate)**
    *   **意义**：衡量客服话术或落地页内容的转化吸引力，反映从对话到成交意向的转化效率。
    *   **计算公式**：`留资转化率 = (留资量 / 开口量) * 100%`
*   **进线留咨率 (Incoming Lead Rate)**
    *   **意义**：衡量整体流量变现能力，反映从流量引入到最终留资的全链路效率。
    *   **计算公式**：`进线留咨率 = (留资量 / 进线量) * 100%`
